"use strict";var e=require("./common/vendor.js");Math;const t={components:{proList:()=>"./components/proList/proList.js"},data:()=>({searchTip:"搜索关键词",swiperDatas:[],autoplay:!0,sortList:[{id:1,img:"https://xcxcs.obs.cn-east-3.myhuaweicloud.com/images/神龙.png",name:"神龙",url:"/sub-play/pages/play"},{id:2,img:"https://xcxcs.obs.cn-east-3.myhuaweicloud.com/images/高达.png",name:"高达",url:"/sub-play/pages/play"},{id:3,img:"https://xcxcs.obs.cn-east-3.myhuaweicloud.com/images/海贼王.png",name:"海贼王",url:"/sub-play/pages/play"},{id:4,img:"https://xcxcs.obs.cn-east-3.myhuaweicloud.com/images/七龙珠.png",name:"七龙珠",url:"/sub-play/pages/play"},{id:5,img:"https://xcxcs.obs.cn-east-3.myhuaweicloud.com/images/手办.png",name:"手办",url:"/sub-play/pages/play"}],title:"",product:[],pageNo:1,total:1,requestUrl:"http://123.60.71.74:20001/"}),onLoad(){this.getJson()},methods:{search(){e.index.navigateTo({url:"search"})},toPage(){e.index.navigateTo({url:"/sub-play/pages/play"})},getJson(){e.index.request({url:"http://123.60.71.74:20001//mh/banner/list",method:"GET",dataType:"JSON",success:e=>{let t=JSON.parse(e.data);this.swiperDatas=t.data}}),e.index.request({url:"http://123.60.71.74:20001//mh/product/page",method:"GET",dataType:"JSON",data:{no:this.pageNo,size:10},success:e=>{let t=JSON.parse(e.data);this.product=t.data.list,this.total=t.data.totalPage}})}},mounted(){}};if(!Array){e.resolveComponent("proList")()}Math;var a=e._export_sfc(t,[["render",function(t,a,o,s,n,p){return e.e({a:e.t(n.searchTip),b:e.o(((...e)=>p.search&&p.search(...e))),c:n.swiperDatas&&n.swiperDatas.length>0},n.swiperDatas&&n.swiperDatas.length>0?{d:e.f(n.swiperDatas,((e,t,a)=>({a:e.imgUrl,b:e.id}))),e:e.o((()=>{})),f:n.autoplay}:{},{g:e.f(n.sortList,((t,a,o)=>({a:t.img,b:e.t(t.name),c:t.id,d:e.o((e=>p.toPage()),t.id)}))),h:e.p({"product-list":n.product,"total-page":n.total})})}]]);const o={onLaunch:function(){console.log("App Launch")},onShow:function(){console.log("App Show"),e.index.onAppShow(this.checkQueue),e.index.onAppShow(this.checkToken)},onHide:function(){console.log("App Hide")},methods:{checkToken(){e.index.request({url:"http://123.60.71.74:20001/wx/mini/user/check",method:"POST",header:{"Content-Type":"application/x-www-form-urlencoded",token:e.index.getStorageSync("token")},success:t=>{console.log("token",t),"555"==t.data.code||"556"==t.data.code?(e.index.showToast({title:"登录过期！",icon:"error"}),setTimeout((()=>{e.index.switchTab({url:"/pages/user"},1e3)}))):e.index.setStorage({key:"token",data:t.data.data})}})},checkQueue(){e.index.request({url:"http://123.60.71.74:20001/mh/user/queue/now",method:"POST",header:{"Content-Type":"application/x-www-form-urlencoded",token:e.index.getStorageSync("token")},success:t=>{console.log("queue",t),t.data.data.productBoxCode&&(e.index.showLoading({title:"跳转至队列"}),e.index.setStorageSync("productCode",t.data.data.productCode),e.index.setStorageSync("productBoxCode",t.data.data.productBoxCode),setTimeout((function(){e.index.hideLoading(),e.index.navigateTo({url:"/sub-play/pages/play"})}),1e3))}})}}};function s(){return{app:e.createSSRApp(o)}}s().app.mount("#app"),exports.MiniProgramPage=a,exports.createApp=s;
