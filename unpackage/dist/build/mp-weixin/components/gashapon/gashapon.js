"use strict";var t=require("../../common/vendor.js");const e={name:"gashapon",props:{quantity:{type:Number,require:!0,default:1}},data:()=>({buttonText:"开始",resultList:[{}],curIdx:0,complete:!1,gifShow:!1,startShow:!0,nextShow:!1,allShow:!1,timestamp:"",salt:"94c3a70edf07f72a",sign:"",productBoxCode:"",productCode:""}),methods:{test(){this.$emit("addTime",!0),console.log("test")},close(){this.$emit("close",!1),this.complete=!1,this.gifShow=!1,this.startShow=!0,this.nextShow=!1,this.allShow=!1,this.curIdx=0,this.buttonText="开始"},start(){var t=this;this.gifShow=!0,this.$emit("close",!0),this.$emit("addTime",!0),this.getResult(),setTimeout((function(){t.complete=!0,1==t.quantity?(t.buttonText="查看全部",t.startShow=!1,t.allShow=!0):(t.buttonText="NEXT",t.startShow=!1,t.nextShow=!0)}),2e3)},getResult(){this.productBoxCode=t.index.getStorageSync("productBoxCode"),this.productCode=t.index.getStorageSync("productCode"),this.timestamp=Date.now();var e=""+this.productBoxCode+this.quantity+this.timestamp+this.salt;this.sign=t.md5(e),t.index.request({url:"http://123.60.71.74:20001//mh/user/lottery/generate",method:"GET",header:{token:t.index.getStorageSync("token")},data:{sign:this.sign,productBoxCode:this.productBoxCode,productCode:this.productCode,lotteryTimes:this.quantity,timestamp:this.timestamp},success:e=>{this.resultList=e.data.data,t.index.setStorage({key:"result",data:this.resultList})}})},next(){var t=this;t.curIdx<t.resultList.length-1&&(t.curIdx++,t.curIdx==t.resultList.length-1&&(t.allShow=!0,t.nextShow=!1,t.buttonText="查看全部"))},all(){t.index.navigateTo({url:"/sub-play/pages/playResult"}),this.close()},skip(){t.index.navigateTo({url:"/sub-play/pages/playResult"}),this.close()}},onShow(){t.index.removeStorage({key:"result"})},mounted(){}};var o=t._export_sfc(e,[["render",function(e,o,s,i,r,a){return{a:!r.complete&&!r.gifShow,b:t.o(((...t)=>a.close&&a.close(...t))),c:r.complete||r.gifShow,d:!r.gifShow,e:r.gifShow,f:!r.complete,g:t.t(r.curIdx+1),h:t.t(s.quantity),i:r.resultList[r.curIdx].imgUrl,j:t.t(r.resultList[r.curIdx].itemTypeName),k:t.t(r.resultList[r.curIdx].productItemName),l:r.complete,m:t.t(r.buttonText),n:r.startShow,o:t.o(((...t)=>a.start&&a.start(...t))),p:t.t(r.buttonText),q:r.nextShow,r:t.o(((...t)=>a.next&&a.next(...t))),s:t.t(r.buttonText),t:r.allShow,v:t.o(((...t)=>a.all&&a.all(...t))),w:r.nextShow,x:t.o(((...t)=>a.skip&&a.skip(...t))),y:t.o(((...t)=>a.test&&a.test(...t)))}}]]);wx.createComponent(o);
