"use strict";var e=require("../../common/vendor.js");const i={data:()=>({dealList:[],hasWish:!1,wishList:[],wishPrice:"",onePrice:"",lowPrice:"",message:"",alert:"",update:!0,changeArr:[]}),onLoad(){this.getJson()},methods:{formSubmit(i){var s=JSON.stringify(i.detail.value);this.check(s)?(console.log(JSON.stringify(i.detail.value),this.wishList),e.index.showToast({title:"发布成功",icon:"none"}),setTimeout((function(){e.index.navigateBack({delta:1})}),1e3)):e.index.showToast({title:this.alert,icon:"none"})},formReset(i){console.log("清空数据"),e.index.navigateTo({url:"bag"})},addWish(){this.wishList.push({id:1,type:"终",img:"https://xcxcs.obs.cn-east-3.myhuaweicloud.com/images/play/pro_19.png",name:"戴珍珠耳环的少女",time:"1656306794497",group:0,sort:"spot",inBag:!0,recover:!1,choose:!1,price:58,point:20,class1:"大分类A",class2:"大分类A-分类a",class3:"大分类A-分类a-品类1",isdeal:!0})},wishShow(){this.wishList=this.hasWish?[]:this.wishList,this.hasWish=!this.hasWish},check(e){var i=this;return i.hasWish&&0==i.wishList.length?(i.alert="求购赏品为空",!1):i.hasWish&&""==i.wishPrice||""==i.onePrice||""==i.lowPrice?(i.alert="请输入金额",!1):!(i.onePrice<=i.lowPrice)||(i.alert="一口价须大于最低价",!1)},blur(e,i){var s=this;switch(e){case"onePrice":s.onePrice=Math.floor(100*i.detail.value)/100;break;case"wishPrice":s.wishPrice=Math.floor(100*i.detail.value)/100;break;case"lowPrice":s.lowPrice=Math.floor(100*i.detail.value)/100;break;default:console.log(e)}},getJson(){e.index.request({url:"https://xcxcs.obs.cn-east-3.myhuaweicloud.com/fake.json",method:"get",dataType:"JSON",success:e=>{let i=JSON.parse(e.data);this.dealList=i.list}})},forceupdate(){this.update=!1,this.update=!0}},mounted(){},watch:{onePrice(e,i){e<0&&(this.onePrice=0)},wishPrice(e,i){e<0&&(this.wishPrice=0)},lowPrice(e,i){e<0&&(this.wishPrice=0)},dealList:function(e,i){console.log("列表更新"),this.forceupdate(),this.dealList.sort((function(e,i){return e.id-i.id}))}}};var s=e._export_sfc(i,[["render",function(i,s,t,a,o,r){return{a:e.f(o.dealList,((e,i,s)=>({a:e.imgUrl,b:i,c:o.update&&e.isdeal}))),b:o.hasWish,c:e.o(((...e)=>r.wishShow&&r.wishShow(...e))),d:e.f(o.wishList,((e,i,s)=>({a:e.img,b:i}))),e:e.o(((...e)=>r.addWish&&r.addWish(...e))),f:e.o((e=>r.blur("wishPrice",e))),g:o.wishPrice,h:e.o((e=>o.wishPrice=e.detail.value)),i:o.hasWish,j:e.o((e=>r.blur("onePrice",e))),k:o.onePrice,l:e.o((e=>o.onePrice=e.detail.value)),m:e.o((e=>r.blur("lowPrice",e))),n:o.lowPrice,o:e.o((e=>o.lowPrice=e.detail.value)),p:o.message,q:e.o((e=>o.message=e.detail.value)),r:e.o(((...e)=>r.formSubmit&&r.formSubmit(...e))),s:e.o(((...e)=>r.formReset&&r.formReset(...e)))}}]]);wx.createPage(s);
