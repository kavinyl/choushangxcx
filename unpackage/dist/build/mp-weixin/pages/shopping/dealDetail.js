"use strict";var e=require("../../common/vendor.js");const s={data:()=>({deal:{},countHour:24,countMinute:0,countSecond:0,wish:{},update:!0,remain:50,cTime:"",hasBid:!1,isMaster:!0,hasBidPrice:0,user:{},successPrice:0}),onLoad(){},methods:{test1(){this.hasBid=!1,this.isMaster=!1},test2(){this.hasBid=!0,this.isMaster=!1},test3(){this.hasBid=!1,this.isMaster=!0},getJson(){e.index.request({url:"https://xcxcs.obs.cn-east-3.myhuaweicloud.com/fake.json",method:"get",dataType:"JSON",success:e=>{let s=JSON.parse(e.data);this.deal=s.shop[2],this.wish=this.deal.wish,this.remain=s.user.account.remain,this.cTime=this.deal.time,this.user=s.user,this.getTime(-8)}})},forceUpdate(){this.update=!1,this.update=!0},goBid(){e.index.navigateTo({url:"bid"})},dealNow(){this.$refs.order.open("center")},bidReady(){var s=this;this.check(this.deal.onePrice)?(e.index.showToast({title:"恭喜您，交易成功！",icon:"success"}),setTimeout((function(){s.$refs.order.close()}),1e3)):e.index.showToast({title:"余额不足，请先充值！",icon:"error"})},bidTen(){this.check(Number(this.deal.lowPrice)+10)?e.index.showToast({title:"出价成功！",icon:"success"}):e.index.showToast({title:"余额不足，请先充值！",icon:"error"})},check(e){return this.remain>=e},getTime(e){var s=new Date,t=Number(s.getTime()),i=Number(this.cTime),o=60*s.getTimezoneOffset()*1e3,a=new Date(i+864e5-t-o-36e5*e),n=a.getDate()-1;console.log(n),this.countHour=a.getHours()+24*n,this.countMinute=a.getMinutes(),this.countSecond=a.getSeconds(),console.log(this.countHour,this.countMinute,this.countSecond)},checkUser(){var s=this;let t=this.user.userName;this.deal.auction.forEach((function(i,o){i.username==t&&(s.hasBid=!0,s.hasBidPrice=i.price,e.index.setStorage({key:"bidPrice",data:i.price}))})),s.deal.username==t&&(s.isMaster=!0)},cancelBid(){this.hasBid=!1},dealSuccess(e){this.$refs.success.open("center"),this.successPrice=e.price},updateDeal(){e.index.showToast({title:"更新成功！",icon:"success"}),setTimeout((function(){e.index.switchTab({url:"/pages/shopping"})}),1e3)},deleteDeal(){e.index.showToast({title:"删除成功！",icon:"success"}),setTimeout((function(){e.index.switchTab({url:"/pages/shopping"})}),1e3)},confirm(){var s=this;e.index.showToast({title:"恭喜您，交易成功！",icon:"success"}),setTimeout((function(){s.$refs.success.close()}),1e3)}},mounted(){},onShow(){this.getJson()},watch:{}};if(!Array){(e.resolveComponent("uni-countdown")+e.resolveComponent("uni-popup"))()}Math||((()=>"../../uni_modules/uni-countdown/components/uni-countdown/uni-countdown.js")+(()=>"../../uni_modules/uni-popup/components/uni-popup/uni-popup.js"))();var t=e._export_sfc(s,[["render",function(s,t,i,o,a,n){return e.e({a:a.deal.userimgUrl,b:e.t(a.deal.username),c:e.p({fontSize:24,"show-day":!1,hour:a.countHour,minute:a.countMinute,second:a.countSecond}),d:e.t(a.deal.info),e:a.wish.has&&!1},(a.wish.has,{}),{h:e.f(a.deal.list,((s,t,i)=>({a:s.imgUrl,b:e.t(s.type),c:t}))),i:e.t(a.deal.lowPrice),j:e.t(a.deal.onePrice),k:e.o(((...e)=>n.bidTen&&n.bidTen(...e))),l:e.o(((...e)=>n.dealNow&&n.dealNow(...e))),m:!a.isMaster,n:e.t(a.deal.auctionTimes),o:e.f(a.deal.auction,((s,t,i)=>({a:e.t(s.floor),b:s.userimgUrl,c:e.t(s.username),d:e.t(s.price),e:e.o((e=>n.dealSuccess(s))),f:t}))),p:a.isMaster,q:a.update,r:!a.hasBid&&!a.isMaster},a.hasBid||a.isMaster?{}:{s:e.o(((...e)=>n.goBid&&n.goBid(...e)))},{t:a.hasBid&&!a.isMaster},a.hasBid&&!a.isMaster?{v:e.t(a.hasBidPrice),w:e.o(((...e)=>n.goBid&&n.goBid(...e))),x:e.o(((...e)=>n.cancelBid&&n.cancelBid(...e)))}:{},{y:!a.hasBid&&a.isMaster},!a.hasBid&&a.isMaster?{z:e.o(((...e)=>n.updateDeal&&n.updateDeal(...e))),A:e.o(((...e)=>n.deleteDeal&&n.deleteDeal(...e)))}:{},{B:e.t(a.deal.onePrice),C:e.t(a.remain),D:e.o(((...e)=>n.bidReady&&n.bidReady(...e))),E:e.sr("order","13a0a78f-1"),F:e.p({type:"center"}),G:e.t(a.successPrice),H:e.o(((...e)=>n.confirm&&n.confirm(...e))),I:e.sr("success","13a0a78f-2"),J:e.p({type:"center"}),K:e.o((e=>n.test1())),L:e.o((e=>n.test2())),M:e.o((e=>n.test3()))})}]]);wx.createPage(t);
