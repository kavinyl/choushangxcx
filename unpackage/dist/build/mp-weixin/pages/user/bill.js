"use strict";var e=require("../../common/vendor.js");const t={data(){return{bill:[],date:this.getDate({format:!0}),isquery:!1,query:[],quertTime:0,queryTotal:0,update:!0}},onShow(){e.index.getStorage({key:"token",success:e=>{this.token=e.data,console.log(this.token),this.getJson()}})},computed:{startDate(){return this.getDate("start")},endDate(){return this.getDate("end")}},methods:{getJson(){e.index.request({url:"http://123.60.71.74:20001//mh/user/currency/history/list/monthly",method:"GET",dataType:"JSON",header:{token:this.token},success:e=>{let t=JSON.parse(e.data);console.log(t),this.bill=t.data,this.changeDealType()}})},bindDateChange:function(e){this.date=e.detail.value,this.billQuery()},getDate(e){const t=new Date;let a=t.getFullYear(),s=t.getMonth()+1,r=t.getDate();return"start"===e?a-=60:"end"===e&&(a+=2),s=s>9?s:"0"+s,r=r>9?r:"0"+r,`${a}-${s}-${r}`},billQuery(){console.log(this.date);var e=this;this.isquery=!0;var t=this.date.split("-");let a=new Date(this.date);this.queryTime=a.getTime(),e.query.year=t[0],e.query.month=t[1],e.query.day=t[2],e.query.list=[],e.queryTotal=0,this.getDayList(),this.forceupdate()},forceupdate(){this.update=!1,this.update=!0},changeDealType(){this.isquery?this.isquery&&this.bill.forEach((function(e){switch(e.dealType){case"10":e.dealTypeName="交易";break;case"20":e.dealTypeName="充值";break;case"30":e.dealTypeName="提现"}})):this.bill.forEach((function(e){e.userCurrencyHistoryVoList.forEach((function(e){switch(e.dealType){case"10":e.dealTypeName="交易";break;case"20":e.dealTypeName="充值";break;case"30":e.dealTypeName="提现"}}))}))},getDayList(){e.index.request({url:"http://123.60.71.74:20001/mh/user/currency/history/list?dealTime="+this.date,method:"GET",dataType:"JSON",header:{token:this.token},success:e=>{let t=JSON.parse(e.data);console.log(t),this.bill=t.data,this.changeDealType()}})}},watch:{query:function(e,t){this.queryTotal=0,e.list.forEach((function(e){"交易"!=e.type&&"提现"!=e.type||console.log(Number(e.amount))}))}}};var a=e._export_sfc(t,[["render",function(t,a,s,r,i,n){return{a:e.f(i.bill,((t,a,s)=>({a:e.t(t.month),b:e.t(t.totalExpend),c:e.f(t.userCurrencyHistoryVoList,((t,a,s)=>({a:e.t(t.dealTime),b:e.t(t.dealTypeName),c:e.t(t.amount),d:a}))),d:a}))),b:i.date,c:n.startDate,d:n.endDate,e:e.o(((...e)=>n.bindDateChange&&n.bindDateChange(...e))),f:!i.isquery,g:e.t(i.query.year),h:e.t(i.query.month),i:e.t(i.query.day),j:i.date,k:n.startDate,l:n.endDate,m:e.o(((...e)=>n.bindDateChange&&n.bindDateChange(...e))),n:e.t(i.queryTotal),o:e.f(i.bill,((t,a,s)=>({a:e.t(t.dealTime),b:e.t(t.dealTypeName),c:e.t(t.amount),d:a}))),p:i.update,q:i.isquery}}]]);wx.createPage(a);
