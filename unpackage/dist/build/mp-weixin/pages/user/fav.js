"use strict";var e=require("../../common/vendor.js");const t={data:()=>({items:["一番赏","手办","盲盒"],styles:[{value:"button",text:"按钮",checked:!0},{value:"text",text:"文字"}],colors:["#FDA804","#4cd964","#dd524d"],current:0,colorIndex:0,activeColor:"#FDA804",styleType:"text",update:!0,favList:[],doSelect:!1,controlShow:!1,selectAll:!1,selectNum:0,token:"",delList:[],pageNo:1,totalPage:1,status:"more",contentText:{contentdown:"点击展示更多",contentrefresh:"加载中",contentnomore:"没有更多了"}}),onShow(){e.index.getStorage({key:"token",success:e=>{this.token=e.data,console.log(this.token),this.getJson()}})},methods:{test(){e.index.request({url:"/static/fake.json",method:"GET",dataType:"JSON",success:e=>{console.log(e.data.user),this.favList=e.data.user.favList,console.log(this.favList)}})},getJson(){var t=this;e.index.request({url:"http://123.60.71.74:20001/mh/user/favourite/page",method:"GET",header:{token:this.token},data:{no:this.pageNo,size:10},dataType:"JSON",success:e=>{console.log(e);let o=JSON.parse(e.data);this.favList=o.data.list,this.totalPage=o.data.totalPage,1==this.totalPage&&(t.status="noMore"),console.log(this.favList)}})},loadMore(t){var o=this;this.pageNo<this.totalPage?(o.pageNo++,this.status="loading",e.index.request({url:"http://123.60.71.74:20001//mh/user/favourite/page",method:"GET",dataType:"JSON",header:{token:o.token},data:{no:o.pageNo,size:10},success:e=>{let t=JSON.parse(e.data);console.log(t.data),t.data.list.forEach((function(e){o.favList.push(e)})),o.status="more"}})):this.status="noMore"},onClickItem(e){this.current!==e.currentIndex&&(this.current=e.currentIndex)},select(){this.doSelect=!this.doSelect,this.controlShow=!this.controlShow},clickFav(e){this.doSelect&&(e.choose=!e.choose);let t=0;this.favList.forEach((function(e,o){e.choose&&t++})),this.selectNum=t},chooseAll(){var e=this;this.selectAll=!this.selectAll,this.favList.forEach((function(t,o){t.choose=e.selectAll})),this.selectNum=this.selectAll?this.favList.length:0},doDelete(){var t=this;0==this.selectNum?e.index.showToast({title:"请选择",icon:"none"}):(t.favList.forEach((function(e){e.choose&&t.delList.push(e.productCode)})),console.log(t.delList.join(",")),e.index.request({url:"http://123.60.71.74:20001//mh/user/favourite/delete?productCodeList="+this.delList.join(","),method:"PUT",header:{"Content-Type":"application/x-www-form-urlencoded",token:this.token},data:{productCodeList:this.delList.join(",")}}).then((o=>{console.log(o),e.index.showToast({title:"已删除"+t.selectNum+"个",icon:"none"}),t.doSelect=!1,t.controlShow=!1,t.selectNum=0,t.delList=[],t.getJson()})))}},mounted(){1==this.totalPage&&(this.status="noMore")},watch:{}};if(!Array){(e.resolveComponent("uni-segmented-control")+e.resolveComponent("uni-load-more"))()}Math||((()=>"../../uni_modules/uni-segmented-control/components/uni-segmented-control/uni-segmented-control.js")+(()=>"../../uni_modules/uni-load-more/components/uni-load-more/uni-load-more.js"))();var o=e._export_sfc(t,[["render",function(t,o,s,l,a,c){return e.e({a:e.o(c.onClickItem),b:e.p({current:a.current,values:a.items,"style-type":a.styleType,"active-color":a.activeColor}),c:e.o((e=>c.select())),d:!a.doSelect,e:e.o((e=>c.select())),f:a.doSelect,g:0===a.current},0===a.current?{h:e.f(a.favList,((t,o,s)=>({a:t.choose&&a.doSelect,b:o,c:"C0000001"==t.class1Code,d:e.o((e=>c.clickFav(t)),o)}))),i:a.doSelect?1:"",j:e.f(a.favList,((t,o,s)=>({a:t.imgUrl,b:t.flagPreSale,c:e.t(t.class1Name),d:e.t(t.price),e:t.flagOffSale,f:o,g:"C0000001"==t.class1Code,h:e.o((e=>c.clickFav(t)),o)}))),k:a.doSelect?1:""}:{},{l:1===a.current},1===a.current?{m:e.f(a.favList,((t,o,s)=>({a:t.choose&&a.doSelect,b:o,c:"C0000002"==t.class1Code,d:e.o((e=>c.clickFav(t)),o)}))),n:a.doSelect?1:"",o:e.f(a.favList,((t,o,s)=>({a:t.imgUrl,b:t.flagPreSale,c:e.t(t.class1Name),d:e.t(t.price),e:t.flagOffSale,f:o,g:"C0000002"==t.class1Code,h:e.o((e=>c.clickFav(t)),o)}))),p:a.doSelect?1:""}:{},{q:2===a.current},2===a.current?{r:e.f(a.favList,((t,o,s)=>({a:t.choose&&a.doSelect,b:o,c:"C0000003"==t.class1Code,d:e.o((e=>c.clickFav(t)),o)}))),s:a.doSelect?1:"",t:e.f(a.favList,((t,o,s)=>({a:t.imgUrl,b:t.flagPreSale,c:e.t(t.class1Name),d:e.t(t.price),e:t.flagOffSale,f:o,g:"C0000003"==t.class1Code,h:e.o((e=>c.clickFav(t)),o)}))),v:a.doSelect?1:""}:{},{w:e.o(c.loadMore),x:e.p({status:a.status,contentText:a.contentText}),y:a.update,z:a.selectAll,A:e.o(((...e)=>c.chooseAll&&c.chooseAll(...e))),B:e.t(a.selectNum),C:e.o((e=>c.doDelete())),D:a.controlShow})}]]);wx.createPage(o);
