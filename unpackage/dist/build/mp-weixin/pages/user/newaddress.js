"use strict";var e=require("../../common/vendor.js");const t={data:()=>({newAddress:{},isAdd:!0,addName:"",addPhone:"",addCity:"",addDetail:"",addDefault:!1,province:"",city:"",area:"",alert:"",textpl:!0,token:"",id:""}),onLoad(){e.index.getStorage({key:"editAdd",success:e=>{this.addName=e.data.name,this.addPhone=e.data.phone,this.addDetail=e.data.detail,this.addDefault=e.data.default,this.id=e.data.id,this.isAdd=!1}}),e.index.getStorage({key:"token",success:e=>{this.token=e.data}})},methods:{onchange(e){const t=e.detail.value;this.province=t[0].text,this.city=t[1].text,this.area=t[2].text},onnodeclick(e){},setDefault(){this.addDefault=!this.addDefault},formSubmit(t){var d=this,a=t.detail.value;this.check()&&(d.isAdd?e.index.request({url:"http://123.60.71.74:20001/mh/user/address/add",method:"POST",header:{token:d.token,"Content-Type":"application/json\t"},data:{customerName:a.name,phone:a.phone,province:d.province,city:d.city,area:d.area,detail:a.detail,flagDefault:Number(d.addDefault)},success:e=>{console.log(e)}}):e.index.request({url:"http://123.60.71.74:20001/mh/user/address/update",method:"PUT",header:{token:d.token,"Content-Type":"application/json\t"},data:{id:d.id,customerName:a.name,phone:a.phone,province:d.province,city:d.city,area:d.area,detail:a.detail,flagDefault:Number(d.addDefault)},success:e=>{console.log(e)}}),d.back()),e.index.removeStorage({key:"editAdd"})},back(){setTimeout((function(){e.index.navigateBack({url:"address",success:e=>{let t=getCurrentPages().pop();t&&t.onLoad(t.forceupdate)}})}),1e3)},check(){return this.addName?this.addPhone?/^[1][3,4,5,6,7,8,9][0-9]{9}$/.test(this.addPhone)?this.addCity?!!this.addDetail||(e.index.showToast({title:"请输入详细地址",icon:"none"}),!1):(e.index.showToast({title:"请输入所在地区",icon:"none"}),!1):(e.index.showToast({title:"请输入正确的手机号",icon:"none"}),!1):(e.index.showToast({title:"请输入联系电话",icon:"none"}),!1):(e.index.showToast({title:"请输入收货人姓名",icon:"none"}),!1)},delAddress(){e.index.request({url:"http://123.60.71.74:20001/mh/user/address/delete?userAddressIdList="+this.id,method:"PUT",header:{token:this.token},success:e=>{console.log(e),this.back()}})}}};if(!Array){e.resolveComponent("uni-data-picker")()}Math;var d=e._export_sfc(t,[["render",function(t,d,a,i,o,s){return e.e({a:o.addName,b:e.o((e=>o.addName=e.detail.value)),c:o.addPhone,d:e.o((e=>o.addPhone=e.detail.value)),e:e.o(s.onchange),f:e.o(s.onnodeclick),g:e.o((e=>o.addCity=e)),h:e.p({placeholder:"请选择地址","popup-title":"请选择城市",collection:"opendb-city-china",field:"code as value, name as text",orderby:"value asc","step-searh":!0,"self-field":"code","parent-field":"parent_code",modelValue:o.addCity}),i:o.addDetail,j:e.o((e=>o.addDetail=e.detail.value)),k:o.addDefault},(o.addDefault,{}),{l:e.o(((...e)=>s.setDefault&&s.setDefault(...e))),m:o.isAdd},(o.isAdd,{}),{n:!o.isAdd},(o.isAdd,{}),{o:!o.isAdd},o.isAdd?{}:{p:e.o(((...e)=>s.delAddress&&s.delAddress(...e)))},{q:e.o(((...e)=>s.formSubmit&&s.formSubmit(...e)))})}]]);wx.createPage(d);
